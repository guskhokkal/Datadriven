import pandas as pd

#jobtech_dataset = pd.read_json("C:\\Users\\alexa\\Downloads\\2022\\2022.json")

chunk_size = 10000  # set the chunk size to 10,000 rows

# create a TextFileReader object to read in the JSON file in chunks
json_reader = pd.read_json("C:\\Users\\alexa\\Downloads\\2022\\2022.json", lines=True, chunksize=chunk_size)

jobtech_nurses = []

for chunk in json_reader:
    # process each chunk of data as needed
    print(chunk.head())
    for index, row in json_reader.iterrows():
    # Loop through each column in the row and check for the term 'nurse'
        for column in json_reader.columns:
            if 'västra götaland' in str(row[column]).lower() and 'chef' in str(row['headline']).lower():
                jobtech_nurses.append(row)
                break

test = pd.DataFrame(jobtech_nurses)

print(test.head(3))
